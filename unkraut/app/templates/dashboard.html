<!-- unkraut/app/templates/dashboard.html -->
{% extends "base.html" %}

{% block title %}Dashboard - Unkraut-2025{% endblock %}
{% block page_title %}Dashboard - Autonomer Roboter{% endblock %}

{% block content %}
<!-- Navigation Grid -->
<div class="nav-grid">
    <a href="/control" class="nav-card btn-success">
        <div class="nav-icon">ğŸ®</div>
        <div class="nav-label">Fahrzeug</div>
        <div class="nav-desc">Roboter steuern</div>
    </a>
    
    <a href="/arm" class="nav-card btn-warning">
        <div class="nav-icon">ğŸ¦¾</div>
        <div class="nav-label">Roboterarm</div>
        <div class="nav-desc">Servo-Steuerung</div>
    </a>
    
    <a href="/camera" class="nav-card btn-info">
        <div class="nav-icon">ğŸ“·</div>
        <div class="nav-label">Kamera</div>
        <div class="nav-desc">Live-Stream</div>
    </a>
    
    <a href="/combined" class="nav-card btn-danger">
        <div class="nav-icon">ğŸ¯</div>
        <div class="nav-label">Kamera+Arm</div>
        <div class="nav-desc">Kombiniert</div>
    </a>
    
    <a href="/ai" class="nav-card btn-secondary">
        <div class="nav-icon">ğŸ§ </div>
        <div class="nav-label">KI-Erkennung</div>
        <div class="nav-desc">Unkraut erkennen</div>
    </a>
    
    <a href="/docs" class="nav-card btn-primary">
        <div class="nav-icon">ğŸ“š</div>
        <div class="nav-label">Docs</div>
        <div class="nav-desc">Dokumentation</div>
    </a>
    
    <a href="/debug" class="nav-card btn-dark">
        <div class="nav-icon">ğŸ”§</div>
        <div class="nav-label">Debug</div>
        <div class="nav-desc">Problemdiagnose</div>
    </a>
</div>

<!-- System Status -->
<div class="grid">
    <div class="card">
        <div class="section-title">ğŸ“Š System Status</div>
        <div id="system-status">Lade Status...</div>
        <button class="btn btn-primary" onclick="updateStatus()">ğŸ”„ Aktualisieren</button>
    </div>
    
    <div class="card">
        <div class="section-title">ğŸ“· Live Kamera</div>
        <img id="camera-stream" src="/api/camera/stream" alt="Kamera Stream">
        <div class="camera-quick-actions">
            <button class="btn btn-primary" onclick="captureImage()">ğŸ“¸ Foto</button>
            <button class="btn btn-success" onclick="detectWeeds()">ğŸ” Unkraut erkennen</button>
        </div>
    </div>
</div>

<!-- Schnellaktionen -->
<div class="card">
    <div class="section-title">âš¡ Schnellaktionen</div>
    <div class="quick-actions">
        <button class="btn btn-success" onclick="moveRobot('forward')">â¬†ï¸ VorwÃ¤rts</button>
        <button class="btn btn-success" onclick="moveRobot('left')">â¬…ï¸ Links</button>
        <button class="btn btn-danger" onclick="stopAll()">â¹ï¸ Stopp</button>
        <button class="btn btn-success" onclick="moveRobot('right')">â¡ï¸ Rechts</button>
        <button class="btn btn-success" onclick="moveRobot('backward')">â¬‡ï¸ RÃ¼ckwÃ¤rts</button>
        <button class="btn btn-warning" onclick="armHome()">ğŸ  Arm Home</button>
        <button class="btn btn-warning" onclick="armWeedRemove()">ğŸŒ¿ Unkraut entfernen</button>
    </div>
</div>

<!-- System-Steuerung -->
<div class="card">
    <div class="section-title">ğŸ”§ System-Steuerung</div>
    <div class="system-controls">
        <button class="btn btn-warning" onclick="parkAndShutdown()" id="shutdown-btn">
            ğŸ  Parken & Herunterfahren
        </button>
        <button class="btn btn-info" onclick="systemReboot()" id="reboot-btn">
            ğŸ”„ Neu starten
        </button>
        <button class="btn btn-danger" onclick="emergencyShutdown()" id="emergency-shutdown-btn">
            ğŸš¨ NOT-SHUTDOWN
        </button>
    </div>
    <div class="system-controls-info">
        <small>
            <strong>Parken & Herunterfahren:</strong> Arm in sichere Position, dann System ausschalten<br>
            <strong>Neu starten:</strong> System sauber neu starten<br>
            <strong>NOT-SHUTDOWN:</strong> Sofort alles stoppen und ausschalten
        </small>
    </div>
</div>

<!-- Status Updates -->
<div class="card">
    <div class="section-title">ğŸ“‹ Status Updates</div>
    <div id="live-status">Keine Ereignisse...</div>
</div>

<!-- Shutdown-BestÃ¤tigung Modal -->
<div id="shutdown-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ğŸ”´ System herunterfahren?</h3>
        </div>
        <div class="modal-body">
            <p>Das System wird sicher heruntergefahren:</p>
            <ul>
                <li>âœ… Alle Motoren werden gestoppt</li>
                <li>âœ… Roboterarm wird geparkt</li>
                <li>âœ… Kamera-Stream wird beendet</li>
                <li>âœ… Sensoren werden deaktiviert</li>
                <li>âœ… System wird ausgeschaltet</li>
            </ul>
            <p><strong>MÃ¶chten Sie fortfahren?</strong></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeShutdownModal()">Abbrechen</button>
            <button class="btn btn-danger" onclick="confirmShutdown()">Herunterfahren</button>
        </div>
    </div>
</div>

<!-- Reboot-BestÃ¤tigung Modal -->
<div id="reboot-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ğŸ”„ System neu starten?</h3>
        </div>
        <div class="modal-body">
            <p>Das System wird sauber neu gestartet. Alle Prozesse werden beendet und das System startet automatisch neu.</p>
            <p><strong>MÃ¶chten Sie fortfahren?</strong></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeRebootModal()">Abbrechen</button>
            <button class="btn btn-warning" onclick="confirmReboot()">Neu starten</button>
        </div>
    </div>
</div>

<!-- Emergency-Shutdown-BestÃ¤tigung Modal -->
<div id="emergency-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ğŸš¨ NOT-SHUTDOWN!</h3>
        </div>
        <div class="modal-body">
            <p><strong>âš ï¸ WARNUNG:</strong> Sofortiges Herunterfahren ohne Wartezeit!</p>
            <p>Das System wird SOFORT gestoppt und ausgeschaltet.</p>
            <p><strong>Nur in NotfÃ¤llen verwenden!</strong></p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeEmergencyModal()">Abbrechen</button>
            <button class="btn btn-danger" onclick="confirmEmergencyShutdown()">NOT-SHUTDOWN</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}