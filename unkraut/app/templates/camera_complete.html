<!-- app/templates/camera_complete.html -->
{% extends "base.html" %}

{% block title %}Kamera - Unkraut-2025{% endblock %}
{% block page_title %}📷 Kamera & Unkraut-Erkennung{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/camera.css') }}">
{% endblock %}

{% block content %}
<!-- Kamera Stream -->
<div class="camera-section">
    <div class="card">
        <h3>📹 Live Kamera-Stream</h3>
        <div class="stream-container">
            <img id="camera-stream" 
                 src="/api/camera/stream" 
                 alt="Kamera Stream" 
                 class="camera-stream">
        </div>
        
        <div class="camera-controls">
            <button id="capture-btn" class="btn btn-primary" onclick="captureImage()">
                📸 Foto aufnehmen
            </button>
            <button class="btn btn-secondary" onclick="toggleStream()">
                🔄 Stream toggle
            </button>
        </div>
        
        <div class="camera-stats">
            <div class="stat-item">
                <span class="stat-label">CPU:</span>
                <span id="cpu-usage" class="stat-value">0%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">RAM:</span>
                <span id="ram-usage" class="stat-value">0%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Temp:</span>
                <span id="cpu-temp" class="stat-value">0°C</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Kamera:</span>
                <span id="camera-status" class="stat-value">Offline</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Roboterarm:</span>
                <span id="arm-status" class="stat-value">Mock</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">FPS:</span>
                <span id="stream-fps" class="stat-value">0 FPS</span>
            </div>
        </div>
    </div>
</div>

<!-- Unkraut-Erkennung -->
<div class="detection-section">
    <div class="card">
        <h3>🌿 Unkraut-Erkennung</h3>
        
        <div class="detection-controls">
            <button class="btn btn-success" onclick="detectWeeds()">
                🔍 Unkraut erkennen
            </button>
            <button class="btn btn-info" onclick="continuousDetection()">
                📹 Kontinuierliche Erkennung
            </button>
        </div>
        
        <div class="detection-results">
            <h4>Erkennungsergebnisse:</h4>
            <div id="detection-results" class="results-display">
                Keine Erkennungen
            </div>
        </div>
        
        <button class="btn btn-secondary" onclick="clearResults()">
            🗑️ Ergebnisse löschen
        </button>
    </div>
</div>

<!-- Bildergalerie -->
<div class="gallery-section">
    <div class="gallery-header">
        <h3>📁 Aufgenommene Bilder</h3>
        <div class="gallery-stats">
            <span id="gallery-count">0 Bilder</span>
            <span id="gallery-size">0 MB</span>
        </div>
    </div>
    
    <div id="image-gallery" class="image-gallery">
        <div class="no-images">
            Keine Bilder aufgenommen
        </div>
    </div>
    
    <div class="gallery-controls">
        <button class="btn btn-info" onclick="loadImageGallery()">
            🔄 Galerie laden
        </button>
        <button class="btn btn-warning" onclick="downloadImages()">
            💾 Bilder herunterladen
        </button>
        <button class="btn btn-danger" onclick="clearImages()">
            🗑️ Alle löschen
        </button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- NUR eine saubere JavaScript-Datei - komplett getrennt! -->
<script src="{{ url_for('static', filename='js/camera_complete.js') }}"></script>
{% endblock %}